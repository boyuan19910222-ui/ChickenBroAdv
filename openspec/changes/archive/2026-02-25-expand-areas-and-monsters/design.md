## Context

当前 `GameData.js` 中有 4 个开放区域和 24 种手工配置属性的怪物。所有怪物都是近战战士类型，无法师/施法类敌人。区域采用 `unlockLevel` 线性解锁。需要扩展到 15 个区域 + ~140 种怪物（含战士/法师两类），并引入属性公式和分支解锁。

**现有数据结构**：
- `GameData.areas` — 区域对象，通过 `monsters: [id, ...]` 引用怪物
- `GameData.monsters` — 怪物对象，手工定义所有属性
- 无 `monsterType` 字段，无法师技能

## Goals / Non-Goals

**Goals:**
- 扩展到 15 个区域，覆盖 Lv 1-60 全等级段
- 每区域 8-10 种怪物（约 50% 战士 + 50% 法师）
- 用公式生成怪物基础属性，保证数值平衡
- 新增法师类技能集
- 区域解锁支持分支路线

**Non-Goals:**
- 不改动副本（dungeon）系统的怪物数据
- 不实现精英/稀有怪物变体（后续迭代）
- 不改动战斗核心引擎逻辑（仅扩展数据和技能）
- 不改动 UI 组件

## Decisions

### D1: 怪物属性公式系统 — 构建时预计算 vs 运行时计算

**决策**: 构建时预计算，将结果写入 `GameData.monsters` 静态数据。

**理由**: 
- 运行时计算增加战斗初始化延迟
- 静态数据便于调试和验证
- 现有代码直接读取 `monsters[id].hp` 等字段，无需改调用方
- 公式只在开发时使用，通过 helper 函数生成数据

**替代方案**: 运行时公式 — 灵活但需改所有读取怪物属性的代码，风险大。

**公式设计**:
```
baseHp(lv)   = 80 + lv × 50 + lv² × 0.3
baseStr(lv)  = 8 + lv × 2.2
baseAgi(lv)  = 4 + lv × 1.2
baseInt(lv)  = 3 + lv × 0.8
baseSta(lv)  = 6 + lv × 1.8
baseExp(lv)  = 10 + lv × 6
baseGoldMin(lv) = 3 + lv × 1.5
baseGoldMax(lv) = 8 + lv × 4

战士系数: { hp: 1.0, str: 1.0, agi: 0.6, int: 0.3, sta: 1.0 }
法师系数: { hp: 0.7, str: 0.4, agi: 0.5, int: 1.3, sta: 0.7 }
```

### D2: 怪物数据组织 — 全部内联 vs 按区域拆分文件

**决策**: 保持全部在 `GameData.js` 的 `monsters` 对象中，但在代码中用注释分区标注。

**理由**:
- 现有代码全部从 `GameData.monsters` 读取，拆文件需改所有导入
- 按区域注释分区即可维护
- 后续如需拆分可独立迁移

**替代方案**: 按区域拆分为 `src/data/monsters/*.js` — 更整洁但改动面大。

### D3: 区域分支解锁 — unlockRequires 字段设计

**决策**: 新增 `unlockRequires` 字段，与现有 `unlockLevel` 并存。解锁条件为 `unlockLevel` AND `unlockRequires` 同时满足。

```javascript
{
  unlockLevel: 17,                     // 等级门槛
  unlockRequires: ['elwynnForest'],    // 前置区域（需已探索）
}
```

**理由**:
- 向后兼容 — `unlockRequires` 为空或缺失时退化为纯等级解锁
- 支持多前置（如 `['westfall', 'duskwood']` 表示需两个区域都探索过）
- 简单直观，不需要新的解锁系统

### D4: 法师类怪物 AI 行为

**决策**: 在怪物数据中添加 `monsterType: 'melee' | 'caster'` 字段，战斗 AI 根据此字段选择行为。

- `melee`: 优先使用物理攻击技能，高仇恨目标优先
- `caster`: 优先使用法术技能，可能选择低血量/高威胁目标

**实现**: 本次变更仅添加字段和技能数据。AI 行为调整作为 stretch goal，不作为核心交付。

### D5: 现有 4 区域 24 怪物的处理

**决策**: 保留并重构现有数据，使其符合新的数据结构（添加 `monsterType`、`unlockRequires` 等字段），同时调整现有怪物的属性值使其与公式生成的值一致。

**理由**: 确保数据一致性，避免新旧怪物数值标准不统一。

## Risks / Trade-offs

- **[数据量大]** 新增 ~116 种怪物 + 11 个区域，约 800-1000 行数据 → 通过公式生成保证一致性，仔细 review 生成结果
- **[技能缺口]** 法师技能引用的技能 ID 需要在技能系统中存在 → 本次同步添加技能定义到 `GameData.skills` 或相应位置
- **[平衡性]** 公式生成的数值可能不完美 → 公式参数可后续微调，先保证数量级正确
- **[区域解锁验证]** 分支解锁需要 UI 展示前置条件 → 本次仅实现数据层，UI 提示为后续优化

## 区域分支拓扑

```
                    ┌→ ❄️ 丹莫罗(6-15) ──→ 🐊 湿地(18-28) ───┐
                    │                                          │
🌲 艾尔文森林(1-10) ┤                                          ├→ 🌿 荆棘谷(22-35) ──┐
                    │                                          │                      │
                    └→ 🌾 西部荒野(10-20) → 🌑 暮色森林(15-25) ┘                      │
                                                                                      │
                    ┌→ 🌋 灼热峡谷(32-42) ──→ 🔥 燃烧平原(50-58)                     │
                    │                                                                  │
🏜️ 荒芜之地(28-38) ←┤                                                                 │
                    │                                                                  │
                    └→ ⛰️ 辛特兰(36-46) ──→ 🍄 费伍德森林(40-50)                      │
                                                    │                                  │
                                                    ↓                ← ← ← ← ← ← ← ←┘
                                           ☠️ 东瘟疫之地(45-55)
                                                    │
                                    ┌───────────────┼───────────────┐
                                    ↓               ↓               ↓
                           🐻‍❄️ 冬泉谷(48-58)  💀 诅咒之地(52-60)  (来自燃烧平原)
                                    │               │
                                    └───────┬───────┘
                                            ↓
                                    🐉 希利苏斯(55-60)
```
