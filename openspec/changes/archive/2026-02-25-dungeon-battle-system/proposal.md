## 背景原因

《鸡哥大冒险》需要实现一套完整的副本战斗系统，参考暗黑地牢(Darkest Dungeon)的战斗风格，结合魔兽世界的职业体系和BOSS机制。当前游戏已有基础战斗规格定义，但缺乏详细的副本战斗实现，包括站位系统、行动点机制、仇恨系统、BOSS阶段转换等核心功能。

## 变更内容

### 核心战斗机制
- 实现站位系统：我方5位置(左侧)，敌方5位置(右侧)
- 实现3点行动点数制，不同技能消耗不同点数
- 实现暗黑地牢式行动顺序（速度+随机惊喜机制）
- 实现职业固定速度系统
- 实现仇恨值累计系统（伤害/治疗产生仇恨，嘲讽2回合）

### BOSS战系统
- 实现BOSS多次行动机制（每回合2-3次）
- 实现血量阶段制（100%-70%-40%-0%）
- 实现BOSS技能预告系统
- 实现狂暴计时器（15回合后触发）
- 实现第一个测试BOSS：哀嚎洞穴·瑟芬迪斯

### 队伍系统
- 实现动态队伍替换（玩家替换对应职业AI）
- 实现按职业定位自动站位分配
- 实现宠物系统（附属单位、跟随主人、独立HP）

### 空位与目标选择
- 阵亡单位保持空位（可复活）
- 目标选择使用逻辑位置（跳过阵亡）
- 近战射程采用混合模式（有最大物理距离限制）

## 功能列表

### 新增功能

- `positioning-system`: 站位系统，管理战场位置、空位处理、目标选择逻辑
- `action-point-system`: 行动点系统，3点制，技能消耗管理
- `turn-order-system`: 回合顺序系统，速度排序+惊喜机制+完全交替
- `threat-system`: 仇恨系统，仇恨值累计、嘲讽机制
- `boss-phase-system`: BOSS阶段系统，血量阈值触发、阶段技能
- `boss-enrage-system`: BOSS狂暴系统，15回合计时器
- `skill-telegraph-system`: 技能预告系统，BOSS大招警告
- `party-formation-system`: 队伍编成系统，动态替换、自动站位
- `pet-combat-system`: 宠物战斗系统，附属单位、独立HP
- `wailing-caverns-boss`: 哀嚎洞穴BOSS数据，瑟芬迪斯三阶段设计

### 修改功能

- `combat-system`: 扩展战斗系统以支持新的站位和行动机制
- `dungeon-system`: 扩展副本系统以支持BOSS战和阶段转换

## 影响范围

- **核心战斗**: 完全重构战斗流程，引入站位、行动点、仇恨等新机制
- **数据结构**: 新增职业速度配置、BOSS数据配置、技能消耗配置
- **用户界面**: 战斗界面需显示站位、行动点、仇恨值、BOSS阶段
- **AI系统**: AI队友需要基于仇恨和站位做出决策
- **依赖关系**: 依赖已完成的9大职业系统和技能系统
