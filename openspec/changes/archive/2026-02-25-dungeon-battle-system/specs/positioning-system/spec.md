## 新增需求

### 需求: 战场站位布局
系统应实现固定的战场站位布局，我方在左侧，敌方在右侧。

#### 场景: 我方站位配置
- **给定** 一场副本战斗开始
- **当** 初始化战场时
- **那么** 我方拥有5个固定位置（位置1-5，从前到后）
- **并且** 位置1为最前排（坦克位），位置5为最后排（治疗位）

#### 场景: 敌方站位配置
- **给定** 一场副本战斗开始
- **当** 初始化战场时
- **那么** 敌方拥有5个固定位置（位置1-5，从前到后）
- **并且** 位置1为最前排，位置5为最后排

### 需求: 空位处理机制
系统应在单位阵亡后保持其物理位置，支持复活机制。

#### 场景: 阵亡单位保持位置
- **给定** 一个单位在位置2
- **当** 该单位阵亡时
- **那么** 位置2标记为空位
- **并且** 该单位的物理位置信息保留

#### 场景: 复活单位恢复位置
- **给定** 一个阵亡单位原本在位置2
- **当** 对该单位施放复活技能时
- **那么** 该单位在原位置2复活
- **并且** 位置2不再标记为空位

### 需求: 逻辑位置计算
系统应支持逻辑位置概念，用于技能目标选择时跳过阵亡单位。

#### 场景: 计算逻辑位置
- **给定** 敌方位置1阵亡，位置2、3、4存活
- **当** 计算敌方逻辑位置时
- **那么** 位置2的逻辑位置为1
- **并且** 位置3的逻辑位置为2
- **并且** 位置4的逻辑位置为3

#### 场景: 技能目标"敌方前2"
- **给定** 一个技能描述为"攻击敌方前2名目标"
- **当** 敌方物理位置1阵亡，位置2、3、4存活
- **那么** 技能攻击物理位置2和3的敌人（逻辑位置1和2）

### 需求: 近战射程规则
系统应实现混合模式的近战射程限制。

#### 场景: 近战攻击距离限制
- **给定** 一个近战单位在我方位置2
- **当** 该单位尝试使用近战攻击时
- **那么** 只能攻击物理距离不超过最大近战距离的目标

#### 场景: 计算物理距离
- **给定** 我方位置2的近战单位
- **并且** 敌方位置1、2、3、4存在单位
- **当** 计算可攻击目标时
- **那么** 敌方位置1距离最近（可攻击）
- **并且** 敌方位置4距离最远（可能超出近战范围）

#### 场景: 空位不阻挡但计入距离
- **给定** 敌方位置1阵亡（空位）
- **当** 近战单位尝试攻击敌方位置2时
- **那么** 物理距离仍然包含空位的格子
- **并且** 可以穿过空位攻击到位置2

---

## 数据结构

### 战场位置配置
```javascript
const BATTLEFIELD_CONFIG = {
  player: {
    positions: 5,
    layout: [
      { slot: 1, role: 'tank', x: 100 },
      { slot: 2, role: 'melee_dps', x: 200 },
      { slot: 3, role: 'ranged_dps', x: 300 },
      { slot: 4, role: 'ranged_dps', x: 400 },
      { slot: 5, role: 'healer', x: 500 }
    ]
  },
  enemy: {
    positions: 5,
    layout: [
      { slot: 1, x: 700, label: '前排1' },
      { slot: 2, x: 800, label: '前排2' },
      { slot: 3, x: 900, label: '后排1' },
      { slot: 4, x: 1000, label: '后排2' },
      { slot: 5, x: 1100, label: '后排3' }
    ]
  },
  melee_max_distance: 400  // 近战最大攻击距离（像素）— 实际实现中 AI 行动未强制调用距离校验
};
```

### 单位位置状态
```javascript
const unitPosition = {
  unitId: 'player_1',
  side: 'player',      // 'player' | 'enemy'
  physicalSlot: 2,     // 物理位置 1-5
  logicalSlot: null,   // 逻辑位置（动态计算）
  isAlive: true,
  x: 200,              // 实际坐标
  y: 300
};
```
